import{d as F,X as M,o as G,M as V,r as g,c as I,y as u,k as m,l as e,q as n,D as w,C as d,G as P,H as C,x as N}from"./vue-vendor-Dw1uN-ft.js";import{u as z,c as A,_}from"./index-CIdx3pTK.js";import{I as L}from"./ui-vendor-D_ZJpqRo.js";import"./utils-CAMFpqwB.js";const B=F({name:"APIView",components:{Icon:L},setup(){const t=V(),s=g(!1),c=g(!1),h=g(!1),x=g(0),v=g(!1),o=g(""),r=g("success"),y=z(),{userInfo:k}=M(y),K=I(()=>y.isLoading),S=I(()=>y.error),T=I(()=>k.value||{}),f=(i,l="success")=>{o.value=i,r.value=l,v.value=!0,setTimeout(()=>{v.value=!1},3e3)},R=async()=>{try{if(c.value)return;c.value=!0;const i=++x.value,l=A.getToken();if(!l)throw new Error("Unauthorized: Please log in first");const p=await fetch("https://api.team695.com/auth/api-keys",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`}});if(!p.ok)throw new Error(`Failed to generate API keys: ${p.statusText}`);const a=await p.json();if(i!==x.value)return;if(!a.success)throw new Error(a.error||"Failed to generate API keys");if(a.data){const b={...k.value||{}};b.accessKey=a.data.accessKey,b.accessSecret=a.data.accessSecret,await y.updateUserInfo(b)}f("Successfully generated new API keys!")}catch(i){console.error("Failed to generate API keys:",i),f(`Failed to generate API keys: ${i instanceof Error?i.message:"Unknown error"}`,"error")}finally{c.value=!1}},E=()=>{h.value=!0},U=async()=>{try{if(c.value)return;c.value=!0,h.value=!1;const i=++x.value,l=A.getToken();if(!l)throw new Error("Unauthorized: Please log in first");const p=await fetch("https://api.team695.com/auth/api-keys",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`}});if(!p.ok)throw new Error(`Reset failed: ${p.statusText}`);const a=await p.json();if(i!==x.value)return;if(!a.success)throw new Error(a.error||"Failed to reset API keys");if(a.data){const b={...k.value||{}};b.accessKey=a.data.accessKey,b.accessSecret=a.data.accessSecret,await y.updateUserInfo(b),f("API keys have been successfully reset! New keys are now active.")}else f("API keys have been successfully reset!")}catch(i){console.error("Failed to reset API keys:",i),f(`Failed to reset API keys: ${i instanceof Error?i.message:"Unknown error"}`,"error")}finally{c.value=!1}},D=()=>{s.value=!s.value},j=async i=>{try{await navigator.clipboard.writeText(i),f("Copied to clipboard!")}catch(l){console.error("Failed to copy text: ",l),f("Failed to copy to clipboard","error")}},$=()=>{y.refreshUserInfo()};return G(()=>{if(!A.isLoggedIn()){t.push({name:"login"});return}y.initializeStore()}),{userData:T,isLoading:K,error:S,showSecret:s,isGeneratingKeys:c,showResetConfirmModal:h,showToast:v,toastMessage:o,toastType:r,toggleSecretVisibility:D,copyToClipboard:j,retryFetchUserInfo:$,generateApiKeys:R,confirmResetApiKeys:E,resetApiKeys:U}}}),Y={class:"px-4 py-6 space-y-6"},H={class:"bg-white rounded-lg shadow overflow-hidden"},O={class:"bg-gradient-to-r from-blue-600 to-indigo-700 px-6 py-4"},X={class:"flex items-center"},q={class:"h-12 w-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center"},W={class:"p-6"},J={key:0,class:"flex justify-center py-8"},Q={key:1,class:"text-center py-6"},Z={class:"h-16 w-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},ee={class:"text-gray-600 mb-6"},se={class:"flex justify-center space-x-4"},te={key:2},oe={class:"flex items-center justify-between mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200"},re={class:"flex items-center"},ne={href:"https://api.team695.com/api-docs/",target:"_blank",class:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},ie={key:0},ae={class:"text-center py-8 px-4 border-2 border-dashed border-gray-300 rounded-lg"},le=["disabled"],de={key:1,class:"space-y-6"},ce={class:"bg-gray-50 rounded-lg p-4 border border-gray-200"},ue={class:"flex justify-between items-center mb-2"},me={class:"bg-gray-50 rounded-lg p-4 border border-gray-200 mb-4"},ye={class:"flex justify-between items-center mb-2"},fe={class:"relative"},pe=["value"],be={class:"bg-gray-50 rounded-lg p-4 border border-gray-200"},ge={class:"flex justify-between items-center mb-2"},we={class:"flex items-center space-x-2"},xe={class:"relative"},he=["type","value"],ve={class:"bg-gray-800 text-gray-200 p-4 rounded-lg overflow-x-auto"},ke={class:"text-xs"},Ie={class:"flex flex-wrap gap-4"},Ae=["disabled"],Pe={class:"mt-4 bg-red-50 border-l-4 border-red-400 p-4"},Ce={class:"flex"},Ke={class:"flex-shrink-0"},Se={class:"bg-yellow-50 border-l-4 border-yellow-400 p-4"},Te={class:"flex"},Re={class:"flex-shrink-0"},Ee={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Ue={class:"bg-white rounded-lg p-6 max-w-md w-full shadow-xl"},De={class:"flex items-start"},je={class:"flex-shrink-0 bg-red-100 rounded-full p-2"},$e={class:"ml-4"},Fe={class:"mt-4 flex justify-end space-x-3"};function Me(t,s,c,h,x,v){const o=N("Icon");return u(),m("div",Y,[e("div",H,[e("div",O,[e("div",X,[e("div",q,[n(o,{icon:"mdi:api",class:"h-6 w-6 text-white"})]),s[9]||(s[9]=e("div",{class:"ml-4"},[e("h2",{class:"text-xl font-bold text-white"},"API Management"),e("p",{class:"text-blue-100"},"Manage your API credentials for Team 695 services")],-1))])]),e("div",W,[t.isLoading?(u(),m("div",J,[n(o,{icon:"mdi:loading",class:"h-10 w-10 animate-spin text-blue-600"})])):t.error?(u(),m("div",Q,[e("div",Z,[n(o,{icon:"mdi:alert-circle",class:"h-10 w-10 text-red-500"})]),s[11]||(s[11]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Error Loading API Information",-1)),e("p",ee,w(t.error),1),e("div",se,[e("button",{onClick:s[0]||(s[0]=(...r)=>t.retryFetchUserInfo&&t.retryFetchUserInfo(...r)),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[n(o,{icon:"mdi:refresh",class:"h-4 w-4 mr-1"}),s[10]||(s[10]=d(" Retry ",-1))])])])):(u(),m("div",te,[e("div",oe,[e("div",re,[n(o,{icon:"mdi:book-open-variant",class:"h-6 w-6 text-blue-600 mr-3"}),s[12]||(s[12]=e("div",null,[e("h3",{class:"font-medium text-gray-900"},"API Documentation"),e("p",{class:"text-sm text-gray-600"},"Learn how to use Team 695's API services")],-1))]),e("a",ne,[n(o,{icon:"mdi:open-in-new",class:"h-4 w-4 mr-1"}),s[13]||(s[13]=d(" View Docs ",-1))])]),!t.userData.accessKey||!t.userData.accessSecret?(u(),m("div",ie,[e("div",ae,[n(o,{icon:"mdi:key-plus",class:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s[14]||(s[14]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No API Keys Found",-1)),s[15]||(s[15]=e("p",{class:"text-gray-600 mb-6 max-w-md mx-auto"}," You don't have any API keys yet. Generate API keys to access Team 695's API services. Your API secret will only be shown once after creation. ",-1)),e("button",{onClick:s[1]||(s[1]=(...r)=>t.generateApiKeys&&t.generateApiKeys(...r)),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 shadow-md",disabled:t.isGeneratingKeys},[n(o,{icon:t.isGeneratingKeys?"mdi:loading":"mdi:key-plus",class:P([{"animate-spin":t.isGeneratingKeys},"h-5 w-5 mr-2"])},null,8,["icon","class"]),d(" "+w(t.isGeneratingKeys?"Generating...":"Generate New API Keys"),1)],8,le)])])):(u(),m("div",de,[e("div",null,[s[19]||(s[19]=e("h3",{class:"text-lg font-medium text-gray-900 mb-3"},"API Endpoint",-1)),e("div",ce,[e("div",ue,[s[17]||(s[17]=e("label",{class:"block text-sm font-medium text-gray-700"},"Base URL",-1)),e("button",{onClick:s[2]||(s[2]=r=>t.copyToClipboard("https://api.team695.com")),class:"text-blue-600 hover:text-blue-500 text-sm flex items-center"},[n(o,{icon:"mdi:content-copy",class:"h-4 w-4 mr-1"}),s[16]||(s[16]=d(" Copy ",-1))])]),s[18]||(s[18]=e("div",{class:"relative"},[e("input",{type:"text",readonly:"",value:"https://api.team695.com",class:"block w-full pr-10 py-2 px-3 border border-gray-300 rounded-md shadow-sm bg-white text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"})],-1))])]),e("div",null,[s[24]||(s[24]=e("h3",{class:"text-lg font-medium text-gray-900 mb-3"},"API Credentials",-1)),e("div",me,[e("div",ye,[s[21]||(s[21]=e("label",{class:"block text-sm font-medium text-gray-700"},"Access Key",-1)),e("button",{onClick:s[3]||(s[3]=r=>t.copyToClipboard(t.userData.accessKey)),class:"text-blue-600 hover:text-blue-500 text-sm flex items-center"},[n(o,{icon:"mdi:content-copy",class:"h-4 w-4 mr-1"}),s[20]||(s[20]=d(" Copy ",-1))])]),e("div",fe,[e("input",{type:"text",readonly:"",value:t.userData.accessKey,class:"block w-full pr-10 py-2 px-3 border border-gray-300 rounded-md shadow-sm bg-white text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},null,8,pe)])]),e("div",be,[e("div",ge,[s[23]||(s[23]=e("label",{class:"block text-sm font-medium text-gray-700"},"Access Secret",-1)),e("div",we,[e("button",{onClick:s[4]||(s[4]=(...r)=>t.toggleSecretVisibility&&t.toggleSecretVisibility(...r)),class:"text-blue-600 hover:text-blue-500 text-sm flex items-center"},[n(o,{icon:t.showSecret?"mdi:eye-off":"mdi:eye",class:"h-4 w-4 mr-1"},null,8,["icon"]),d(" "+w(t.showSecret?"Hide":"Show"),1)]),e("button",{onClick:s[5]||(s[5]=r=>t.copyToClipboard(t.userData.accessSecret)),class:"text-blue-600 hover:text-blue-500 text-sm flex items-center"},[n(o,{icon:"mdi:content-copy",class:"h-4 w-4 mr-1"}),s[22]||(s[22]=d(" Copy ",-1))])])]),e("div",xe,[e("input",{type:t.showSecret?"text":"password",readonly:"",value:t.userData.accessSecret,class:"block w-full pr-10 py-2 px-3 border border-gray-300 rounded-md shadow-sm bg-white text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},null,8,he)])])]),e("div",null,[s[25]||(s[25]=e("h3",{class:"text-lg font-medium text-gray-900 mb-3"},"Example API Request",-1)),e("div",ve,[e("pre",ke,[e("code",null,`curl -X GET "https://api.team695.com/auth/me" \\
    -H "X-API-Key: `+w(t.userData.accessKey||"YOUR_ACCESS_KEY")+`" \\
    -H "X-API-Secret: `+w(t.showSecret?t.userData.accessSecret||"YOUR_ACCESS_SECRET":"************************")+'"',1)])])]),e("div",null,[s[28]||(s[28]=e("h3",{class:"text-lg font-medium text-gray-900 mb-3"},"API Key Management",-1)),e("div",Ie,[e("button",{onClick:s[6]||(s[6]=(...r)=>t.confirmResetApiKeys&&t.confirmResetApiKeys(...r)),class:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-red-600 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 shadow-sm",disabled:t.isGeneratingKeys},[n(o,{icon:"mdi:key-remove",class:"h-4 w-4 mr-2"}),s[26]||(s[26]=d(" Reset API Keys ",-1))],8,Ae)]),e("div",Pe,[e("div",Ce,[e("div",Ke,[n(o,{icon:"mdi:alert",class:"h-5 w-5 text-red-400"})]),s[27]||(s[27]=e("div",{class:"ml-3"},[e("p",{class:"text-sm text-red-700"},[e("strong",null,"Warning:"),d(" Resetting your API keys will invalidate any existing keys. All applications using these credentials will need to be updated. ")])],-1))])])]),e("div",Se,[e("div",Te,[e("div",Re,[n(o,{icon:"mdi:shield-alert",class:"h-5 w-5 text-yellow-400"})]),s[29]||(s[29]=e("div",{class:"ml-3"},[e("h3",{class:"text-sm font-medium text-yellow-800"},"Security Notice"),e("p",{class:"text-sm text-yellow-700 mt-1"}," Keep your API credentials secure. Never share your Access Secret or include it in client-side code. If you suspect your credentials have been compromised, reset them immediately. ")],-1))])])]))]))])]),t.showResetConfirmModal?(u(),m("div",Ee,[e("div",Ue,[e("div",De,[e("div",je,[n(o,{icon:"mdi:alert",class:"h-6 w-6 text-red-600"})]),e("div",$e,[s[30]||(s[30]=e("h3",{class:"text-lg font-medium text-gray-900"},"Reset API Keys?",-1)),s[31]||(s[31]=e("p",{class:"mt-2 text-sm text-gray-500"}," This action will permanently delete your current API keys. All applications using these credentials will stop working. Are you sure you want to continue? ",-1)),e("div",Fe,[e("button",{onClick:s[7]||(s[7]=r=>t.showResetConfirmModal=!1),class:"bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Cancel "),e("button",{onClick:s[8]||(s[8]=(...r)=>t.resetApiKeys&&t.resetApiKeys(...r)),class:"bg-red-600 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"}," Reset Keys ")])])])])])):C("",!0),t.showToast?(u(),m("div",{key:1,class:P(["fixed top-4 right-4 px-4 py-2 rounded shadow-lg z-50 transition-opacity duration-300",t.toastType==="success"?"bg-green-600 text-white":"bg-red-600 text-white"])},w(t.toastMessage),3)):C("",!0)])}const _e=_(B,[["render",Me],["__scopeId","data-v-8ad708ea"]]);export{_e as default};
